{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-ecddb6a9bdb34a7e.js","node_modules/@parcel/runtime-js/lib/runtime-6ee5c0ed64aa72b3.js","src/js/library-all.js"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"85Ywi\\\":\\\"library.5d6c6b4c.js\\\",\\\"9u86a\\\":\\\"oops.8ae0f690.jpg\\\",\\\"708jO\\\":\\\"library.8c0d590e.js\\\"}\"));","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"9u86a\")).toString();","const axios = require('axios');\nimport imageURL from '../images/oops.jpg';\nconst API_KEY = '5fe2b2c003e2bf661ee6b8424d931ac2';\nconst IMG_REGUEST = 'https://image.tmdb.org/t/p/w500';\n\nconst myLibraryEl = document.querySelector('.header__list');\nconst filmListEl = document.querySelector('[data-movies]');\n\nconst closeBtn = document.querySelector('.close-library-modal');\nconst backdropEl = document.querySelector('.library-backdrop');\nconst playerEl = document.querySelector('.library-modal-trailer');\nconst linkBox = document.querySelector('#modal-div-link');\nconst libraryRemoveBtn = document.querySelector('.library-modal-btn');\n\nlet watchedEl = localStorage.getItem('STORAGE_KEY_WATCHED');\n\nlet queueEl = localStorage.getItem('STORAGE_KEY_QUEUE');\n\nlet libraryAllEl = '';\ncheckedLS();\n\nmyLibraryEl.addEventListener('click', checkEventLibrary);\nfilmListEl.addEventListener('click', checkEventModal);\ncloseBtn.addEventListener('click', closeModal);\n\nlibraryRemoveBtn.addEventListener('click', deleteFromLibraryAndLS);\n\nfunction checkedLS() {\n  filmListEl.innerHTML = '';\n  if (\n    (queueEl === null && watchedEl === null) ||\n    (queueEl === '[]' && watchedEl === '[]') ||\n    (queueEl === null && watchedEl === '[]') ||\n    (queueEl === '[]' && watchedEl === null)\n  ) {\n    const marckup = `<div class=\"library__empty-container\"><div class=\"library__empty\"><div class=\"left__eye\"></div><div class=\"right__eye\"></div></div><p class=\"library__text-white\">Your library is <span class=\"library__text-red\">empty!</span></p></div>`;\n    filmListEl.innerHTML = marckup;\n    return;\n  } else if (queueEl === null) {\n    libraryAllEl = JSON.parse(watchedEl);\n    getId();\n  } else if (watchedEl === null) {\n    libraryAllEl = JSON.parse(queueEl);\n    getId();\n  } else {\n    libraryAllEl = JSON.parse(watchedEl).concat(JSON.parse(queueEl));\n    getId();\n  }\n}\n\nfunction checkEventLibrary(evt) {\n  if (evt.target.innerText === 'MY LIBRARY') {\n    getId();\n  }\n}\n\nfunction getId() {\n  // if (libraryAllEl.length === 0) {\n  //   return;\n  // }\n  libraryAllEl.forEach(element => {\n    getElementById(element);\n  });\n}\n\nasync function getElementById(id) {\n  const respounse = await axios\n    .get(\n      `https://api.themoviedb.org/3/movie/${id}?api_key=${API_KEY}&language=en-US`\n    )\n    .then(respounse => {\n      renderMarckup(respounse.data);\n    });\n}\n\nfunction renderMarckup(data) {\n  const genres = data.genres.map(el => el.name);\n  const marckup = `<li class=\"films__item\" data-id = ${data.id}>\n      <img src=${\n        data.poster_path ? IMG_REGUEST + data.poster_path : imageURL\n      } alt=${data.title} class=\"film_img\"/>\n      <p class=\"film__name\">${data.title}</p>\n      <p class=\"film__description\">${genres} | ${data.release_date.slice(\n    0,\n    4\n  )}</p>\n    </li>`;\n\n  filmListEl.innerHTML += marckup;\n}\n\nfunction checkEventModal(evt) {\n  const target = evt.target.closest('.films__item');\n  if (target) {\n    const idAttribute = target.getAttribute('data-id');\n    openModal();\n    renderModalLink(idAttribute);\n    getVideoUrlAndRenderPlayer(idAttribute);\n    chekModalBtn(idAttribute);\n  } else {\n    return;\n  }\n}\n\nfunction openModal() {\n  libraryRemoveBtn.disabled = false;\n  backdropEl.classList.remove('library-backdrop-is-hiden');\n  window.addEventListener('keydown', closeModal);\n  backdropEl.addEventListener('click', closeModal);\n}\n\nfunction closeModal(e) {\n  if (\n    e.target.classList.contains('library-backdrop') ||\n    e.code === 'Escape' ||\n    e.target.classList.contains('close-library-modal') ||\n    e.target.classList.contains('library-modal-img')\n  ) {\n    backdropEl.classList.add('library-backdrop-is-hiden');\n    playerEl.innerHTML = '';\n    window.removeEventListener('keydown', closeModal);\n    backdropEl.removeEventListener('click', closeModal);\n    console.clear();\n  }\n}\n\nasync function getVideoUrlAndRenderPlayer(movie) {\n  const data = await axios\n    .get(\n      `https://api.themoviedb.org/3/movie/${movie}/videos?api_key=${API_KEY}&language=en-US`\n    )\n    .then(results => {\n      if (results.data.results.length === 0) {\n        playerEl.innerHTML = `<div class = \"library-modal-iframe\" data-id = ${movie}></div>`;\n        return;\n      }\n      return results.data.results.map(el => {\n        if (el.site === 'YouTube') {\n          const marcup = `<iframe class=\"library-modal-iframe\" data-id = \"${movie}\" \n   src=\"https://www.youtube.com/embed/${el.key}?&autoplay=1\"\n   frameborder=\"0\" allowfullscreen></iframe>`;\n          playerEl.innerHTML = marcup;\n        }\n      });\n    });\n}\n\nasync function renderModalLink(movie) {\n  const respounse = await axios\n    .get(\n      `https://api.themoviedb.org/3/movie/${movie}?api_key=${API_KEY}&language=en-US`\n    )\n    .then(respounse => {\n      const homepage = respounse.data.homepage;\n      return homepage;\n    })\n    .then(homepage => {\n      if (homepage === '') {\n        linkBox.innerHTML = '';\n      } else {\n        const marckup = `<a href=\"${homepage}\" rel=\" noopener noreferrer nofollow \" target = \"blank\" class=\"library-modal-link\">NETFLIX</a>`;\n        linkBox.innerHTML = marckup;\n      }\n    });\n}\n\nfunction chekModalBtn(id) {\n  if (watchedEl.includes(id)) {\n    libraryRemoveBtn.innerText = 'REMOVE FROM WATCHED';\n  } else {\n    libraryRemoveBtn.innerText = 'REMOVE FROM QUEUE';\n  }\n}\n\nfunction deleteFromLibraryAndLS(evt) {\n  evt.currentTarget.disabled = true;\n  const element = backdropEl.querySelector('.library-modal-iframe');\n  const idAttribute = element.getAttribute('data-id');\n  const findEl = document.querySelector(`[data-id=\"${idAttribute}\"]`);\n  findEl.remove();\n\n  if (watchedEl.includes(idAttribute)) {\n    const watchEl = localStorage.getItem('STORAGE_KEY_WATCHED');\n    const arraysWatchId = JSON.parse(watchEl);\n    const newWatchArrId = arraysWatchId.filter(item => item !== idAttribute);\n    const newWatchedString = JSON.stringify(newWatchArrId);\n    localStorage.removeItem('STORAGE_KEY_WATCHED');\n    localStorage.setItem('STORAGE_KEY_WATCHED', newWatchedString);\n    // location.reload();\n    closeModal();\n    // checkedLS();\n  } else {\n    const queEl = localStorage.getItem('STORAGE_KEY_QUEUE');\n    const arraysQueId = JSON.parse(queEl);\n    const newQueArrId = arraysQueId.filter(item => item !== idAttribute);\n    const newQueueString = JSON.stringify(newQueArrId);\n    localStorage.removeItem('STORAGE_KEY_QUEUE');\n    localStorage.setItem('STORAGE_KEY_QUEUE', newQueueString);\n    // location.reload();\n    closeModal();\n    // checkedLS();\n  }\n}\n"],"names":["$ef7689007096c8a0$export$6503ec6e8aabbaf","$ef7689007096c8a0$export$f7ad0328861e2f03","$ef7689007096c8a0$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","$dc4ca2b557cfd915$exports","URL","resolve","import","meta","url","toString","$3c2139bdb80bd986$var$myLibraryEl","document","querySelector","$3c2139bdb80bd986$var$filmListEl","$3c2139bdb80bd986$var$closeBtn","$3c2139bdb80bd986$var$backdropEl","$3c2139bdb80bd986$var$playerEl","$3c2139bdb80bd986$var$linkBox","$3c2139bdb80bd986$var$libraryRemoveBtn","$3c2139bdb80bd986$var$watchedEl","localStorage","getItem","$3c2139bdb80bd986$var$queueEl","$3c2139bdb80bd986$var$libraryAllEl","$3c2139bdb80bd986$var$getId","forEach","element","async","$2shzp","get","then","respounse","data","genres","map","el","name","marckup","poster_path","$parcel$interopDefault","title","release_date","slice","innerHTML","$3c2139bdb80bd986$var$renderMarckup","$3c2139bdb80bd986$var$getElementById","$3c2139bdb80bd986$var$closeModal","e","target","classList","contains","code","add","window","removeEventListener","console","clear","concat","$3c2139bdb80bd986$var$checkedLS","addEventListener","evt","innerText","closest","idAttribute","getAttribute","disabled","remove","movie","homepage","$3c2139bdb80bd986$var$renderModalLink","results","site","marcup","key","$3c2139bdb80bd986$var$getVideoUrlAndRenderPlayer","includes","currentTarget","watchEl","newWatchArrId","filter","item","newWatchedString","stringify","removeItem","setItem","queEl","newQueArrId","newQueueString"],"version":3,"file":"library.5d6c6b4c.js.map"}